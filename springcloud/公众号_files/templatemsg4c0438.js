define("pages/modules/media_dialog/image_dialog/image_content.tpl.js",[],function(i,s,a){return'<div class="img_crop_panel">  <div class="appmsg_conent_img_container">      <div v-if="!imgInfo || imgInfo.length <= 0 || noImgShow" class="page_msg large simple default">          <div class="inner">              <span class="msg_icon_wrp"><i class="icon_msg info"></i></span>              <div class="msg_content">                  <h4>正文中无可用做封面的图片</h4>                  <p>封面图片必须为正文中使用过的图片，图片尺寸需大于200*200px，请在正文中插入图文后再选择封面图片</p>              </div>          </div>      </div>      <div v-else class="appmsg_content_img_hd">          <p class="appmsg_content_img_desc">请从正文使用过的图片中选择封面<span class="appmsg_content_img_tips">尺寸小于200*200的图片已被自动过滤</span></p>      </div>      <ul class="appmsg_content_img_list">        <li v-for="(info, i) in imgInfo" :class="[\'appmsg_content_img_item\', !!info.isRemote ? \'loading_item\' : \'\', !!info.selected ? \'selected\' : \'\']" @click="selectImg(i)">          <div v-if="info.show">            <span class="appmsg_content_img cover" :data-remoteid="!!info.isRemote&&!!info.uid ? info.uid : \'\'" :style="\'background-image:url(\' + info.url + \');\'"></span>            <div class="card_mask_global apmsg_content_img_mask">                <i class="icon_card_selected_global"></i>            </div>                        <div v-if="!!info.isRemote" class="card_mask_global apmsg_content_loading_mask">              <i class="icon32_loading dark"></i>              <span class="vm_box"></span>            </div>          </div>          <div v-else>          </div>        </li>      </ul>  </div></div>'})
define("pages/modules/media_dialog/image_dialog/image_dialog_store.js",["pages/modules/media_dialog/image_dialog/mutations.js","pages/modules/utils/cgi.js","pages/modules/utils/url.js"],function(e,t,o){"use strict"
var i,p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]
for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},A=e("pages/modules/media_dialog/image_dialog/mutations.js")
function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t]
return o}return Array.from(e)}var s=e("pages/modules/utils/cgi.js"),d=e("pages/modules/utils/url.js").fullUrl
function U(e,t){for(var o=0,i=e.length;o<i;++o)if(String(e[o].fileId)===String(t))return o
return-1}function c(e,t){var o=-1
return 0<=e.length&&(o=U(e,t.fileId)),-1!==o}var a={moduleName:"imageDialog",namespaced:!0,state:{scene:"cdn",innerStep:1,totalnum:0,maxSelect:1,perpage:12,currentPage:1,waterStatus:0,imgs:[],groups:[],selectedGroup:0,selectedImgs:[],cropImg:{url:""},cropImgInfo:[],cropperInfo:[],showLoading:!1,covertingCount:0,fromUpload:[],addGroupForm:{groupName:""},btnLoading:!1,addGroupLoading:!1,groupIdOfUploading:0,addGroupPopoverShow:!1,showSelectImg:!1},mutations:(i={},n(i,A.INNER_STEP_MUTATION,function(e,t){e.innerStep=1*t}),n(i,A.WATER_STATUS_MUTATION,function(e,t){e.waterStatus=1*t}),n(i,A.INIT_IMGS_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.imgs=t)}),n(i,A.UPDATE_IMGS_MUTATION,function(e,t){var o=t.idx,i=t.item
if(i){var n=[].concat(r(e.imgs))
n[o]=i,e.imgs=n}}),n(i,A.ADD_IMGS_MUTATION,function(e,t){if(t){var o=[].concat(r(e.imgs))
o.unshift(t),e.imgs=o}}),n(i,A.REMOVE_IMGS_MUTATION,function(e,t){var o=[].concat(r(e.imgs))
o.splice(t,1),e.imgs=o}),n(i,A.UPDATE_IMG_URL_MUTATION,function(e,t){var o=t.idx,i=t.url
i&&(e.imgs[o].url=i)}),n(i,A.INIT_GROUPS_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.groups=t)}),n(i,A.UPDATE_GROUPS_MUTATION,function(e,t){var o=t.idx,i=t.item
e.groups.splice(o,1,i)}),n(i,A.SELECTED_GROUP_MUTATION,function(e,t){e.selectedGroup=t}),n(i,A.SELECTED_IMGS_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.selectedImgs=t)}),n(i,A.UPDATE_SELECTED_IMGS_MUTATION,function(e,t){var o=t.img,i=t.idx
if(o){var n=[].concat(r(e.selectedImgs))
n[i]=o,e.selectedImgs=n}}),n(i,A.ADD_SELECTED_IMGS_MUTATION,function(e,t){t&&e.selectedImgs.push(t)}),n(i,A.REMOVE_SELECTED_IMGS_MUTATION,function(e,t){e.selectedImgs.splice(t,1)}),n(i,A.UPDATE_SELECTED_IMGS_URL_MUTATION,function(e,t){var o=t.idx,i=t.url
i&&(e.selectedImgs[o].url=i)}),n(i,A.TOTAL_NUM_MUTATION,function(e,t){e.totalnum=1*t}),n(i,A.CROP_IMG_MUTATION,function(e,t){e.cropImg=t}),n(i,A.CROP_IMG_INFO_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.cropImgInfo=t)}),n(i,A.CROPPER_INFO_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.cropperInfo=t)}),n(i,A.UPDATE_COVERTING_COUNT_MUTATION,function(e,t){e.covertingCount+=1*t}),n(i,A.FROM_UPLOAD_MUTATION,function(e,t){t?e.fromUpload.push(t):e.fromUpload=[]}),n(i,A.CURRENT_PAGE_MUTATION,function(e,t){e.currentPage=1*t}),i),actions:{resetStateAction:function(e){var t=e.dispatch,o=e.commit
o(A.INNER_STEP_MUTATION,1),o(A.DEFAULT_GROUP_MUTATION,0),o(A.WATER_STATUS_MUTATION,0),o(A.INIT_IMGS_MUTATION,[]),o(A.SELECTED_GROUP_MUTATION,0),o(A.SELECTED_IMGS_MUTATION,[]),o(A.CURRENT_PAGE_MUTATION,1),o(A.TOTAL_NUM_MUTATION,0),o(A.FROM_UPLOAD_MUTATION,null),t("__set_state",{showLoading:!1,btnLoading:!1,addGroupLoading:!1,showSelectImg:!1})},setInnerStepAction:function(e,t){(0,e.commit)(A.INNER_STEP_MUTATION,t)},setSelectedGroupAction:function(e,t){(0,e.commit)(A.SELECTED_GROUP_MUTATION,t)},setSelectedImgsAction:function(e,t){(0,e.commit)(A.SELECTED_IMGS_MUTATION,t)},setTotalNumAction:function(e,t){(0,e.commit)(A.TOTAL_NUM_MUTATION,1*t)},setCurrentPageAction:function(e,t){(0,e.commit)(A.CURRENT_PAGE_MUTATION,t)},setCropperInfoAction:function(e,t){(0,e.commit)(A.CROPPER_INFO_MUTATION,t)},setCropImgInfoAction:function(e,t){(0,e.commit)(A.CROP_IMG_INFO_MUTATION,t)},setCropImgAction:function(e,t){(0,e.commit)(A.CROP_IMG_MUTATION,t)},setFromUploadAction:function(e,t){(0,e.commit)(A.FROM_UPLOAD_MUTATION,t)},updateGroups:function(e,t){(0,e.commit)(A.UPDATE_GROUPS_MUTATION,t)},changeCovertingCount:function(e,t){(0,e.commit)(A.UPDATE_COVERTING_COUNT_MUTATION,1*t)},replaceImgs:function(e,t){var o=e.commit,i=t.idx,n=t.item,r=t.selected
n.selected=!!r,o(A.UPDATE_IMGS_MUTATION,{idx:i,item:n})},addImgs:function(e,t){var o=e.commit,i=t.item,n=t.selected
i.selected=!!n,o(A.ADD_IMGS_MUTATION,i)},removeImgs:function(e,t){(0,e.commit)(A.REMOVE_IMGS_MUTATION,t)},updateSelectedImg:function(e,t){var o=e.commit,i=t.img,n=t.idx,r=t.selected
i.selected=!!r,o(A.UPDATE_SELECTED_IMGS_MUTATION,{img:i,idx:n})},selectImg:function(e,t){var o=e.state,i=e.dispatch,n=e.commit,r=t.i,c=t.currentImg,a=t.forceSelect
if(!c.error){var s=c.url,_=c.fileId,l=c.format,m=c.status,T=c.name
if(o.showSelectImg){var g=p({},o.selectedImgs[r]),u=U(o.imgs,_)
i("updateSelectedImg",{img:{url:s,name:T,fileId:_,format:l,copyrightStatus:m},idx:r,selected:!g.selected}),0<=u&&i("replaceImgs",{idx:u,item:g,selected:!g.selected})}else{var I=p({},o.imgs[r])
if(a)-1===U(o.selectedImgs,_)&&n(A.ADD_SELECTED_IMGS_MUTATION,{url:s,name:T,fileId:_,format:l,copyrightStatus:m,selected:!0}),i("replaceImgs",{idx:r,item:I,selected:!0})
else if(I.selected){var d=U(o.selectedImgs,_)
0<=d&&n(A.REMOVE_SELECTED_IMGS_MUTATION,d),i("replaceImgs",{idx:r,item:I,selected:!1})}else if(1===o.maxSelect){if(o.selectedImgs[0]){var f=U(o.imgs,o.selectedImgs[0].fileId)
if(0<=f)i("replaceImgs",{idx:f,item:p({},o.imgs[f]),selected:!1})
n(A.REMOVE_SELECTED_IMGS_MUTATION,0)}i("replaceImgs",{idx:r,item:I,selected:!0}),n(A.ADD_SELECTED_IMGS_MUTATION,{url:s,name:T,fileId:_,format:l,copyrightStatus:m,selected:!0})}else if(o.selectedImgs.length<o.maxSelect){-1===U(o.selectedImgs,_)&&n(A.ADD_SELECTED_IMGS_MUTATION,{url:s,name:T,fileId:_,format:l,copyrightStatus:m,selected:!0}),i("replaceImgs",{idx:r,item:I,selected:!0})}}"cdn"===o.scene&&!s&&_&&i("getCdnUrlByFileId",_)}},selectGroup:function(e,t){var o=e.state,i=e.dispatch,n=e.commit
n(A.SELECTED_GROUP_MUTATION,t),n(A.CURRENT_PAGE_MUTATION,1),i("__set_state",{showLoading:!0,showSelectImg:!1}),i("resetSelectedImgs"),i("getImagesByBegin",0).then(function(e){i("setTotalNumById",e.page_info.file_group_list.file_group),i("formatData",e).then(function(){i("__set_state",{showLoading:!1}),o.imgs.forEach(function(e,t){c(o.selectedImgs,e)&&i("selectImg",{i:t,currentImg:e,forceSelect:!0})})}).catch(function(){i("__set_state",{showLoading:!1})})}).catch(function(){console.log("get images error"),i("__set_state",{showLoading:!1})})},setTotalNumById:function(e,t){for(var o=e.state,i=e.commit,n=1<arguments.length&&void 0!==t?t:[],r=0,c=n.length;r<c;r++)if(n[r].id===o.selectedGroup){i(A.TOTAL_NUM_MUTATION,n[r].count)
break}},formatData:function(e,t){var T=e.state,g=e.dispatch,u=e.commit,I=[]
return new Promise(function(n,e){t.page_info||e()
var r=0,c=0,a=0,s=t.page_info.file_item.length,_=T.selectedGroup,l=T.currentPage,m=""
u(A.INIT_GROUPS_MUTATION,t.page_info.file_group_list.file_group),u(A.WATER_STATUS_MUTATION,t.page_info.watermark_status),(!t.page_info.file_item||t.page_info.file_item.length<=0)&&e(),t.page_info.file_item.forEach(function(t,o){var i=t.cdn_url||d("/cgi-bin/getimgdata?mode=small&source=file&fileId="+t.file_id),e=new Image
e.onerror=function(){++r,m=m+i+" ",++a===s&&((new Image).src="/mp/jsmonitor?idkey=28308_9_"+r+";28308_10_"+c+"&lc=1&log0=[errorurl]["+encodeURIComponent(m)+"]"),T.selectedGroup===_&&T.currentPage===l&&(I[o]={seq:t.seq,url:i,name:t.name,fileId:t.file_id,status:t.copyright_status||0,format:t.img_format,selected:!1},a===s&&(g("__set_state",{showLoading:!1}),u(A.INIT_IMGS_MUTATION,I),n()))},e.onload=function(){if(++c,++a===s){var e="/mp/jsmonitor?idkey=28308_9_"+r+";28308_10_"+c
0<r&&(e=e+"&lc=1&log0=[errorurl]["+encodeURIComponent(m)+"]"),(new Image).src=e}T.selectedGroup===_&&T.currentPage===l&&(I[o]={seq:t.seq,url:i,name:t.name,fileId:t.file_id,status:t.copyright_status||0,format:t.img_format,selected:!1},a===s&&(u(A.INIT_IMGS_MUTATION,I),n()))},e.src=i})})},getImagesByBegin:function(e,t){var i=e.state,o=e.commit,n=1<arguments.length&&void 0!==t?t:0,r=i.selectedGroup
o(A.INIT_IMGS_MUTATION,[])
var c=d("/cgi-bin/filepage?action=select")
return new Promise(function(t,o){s.get({url:c,data:{group_id:r,begin:n,count:i.perpage,type:2},mask:!1},function(e){e.base_resp&&0===e.base_resp.ret?(i.selectedGroup!==r&&o(),t(e)):(s.handleRet(e,{url:c}),Vue.prototype.$tipsErr("系统繁忙，请稍后尝试"),o())},function(){Vue.prototype.$tipsErr("系统繁忙，请稍后尝试"),o()})})},getCdnUrlByFileId:function(e,i){var n=e.state,r=e.commit
r(A.UPDATE_COVERTING_COUNT_MUTATION,1),s.post({url:d("/cgi-bin/uploadimg2cdn?action=duplicate"),data:{file_id:i,group_id:n.selectedGroup||1},mask:!1},function(e){var t=U(n.selectedImgs,i),o=U(n.imgs,i)
0===Number(e.errcode)?(0<=t&&r(A.UPDATE_SELECTED_IMGS_URL_MUTATION,{idx:t,url:e.url}),0<=o&&r(A.UPDATE_IMG_URL_MUTATION,{idx:t,url:e.url})):(Vue.prototype.$tipsErr("转存失败"),0<=t&&r(A.REMOVE_SELECTED_IMGS_MUTATION,t),0<=o&&r(A.REMOVE_IMGS_MUTATION,t)),r(A.UPDATE_COVERTING_COUNT_MUTATION,-1)},function(){Vue.prototype.$tipsErr("系统繁忙，请稍后尝试")})},createGroup:function(e){var o=e.state,c=e.dispatch,a=e.commit
c("__set_state",{addGroupLoading:!0}),s.post({url:d("/cgi-bin/filepage"),data:{action:"create_group",name:o.addGroupForm.groupName},mask:!1},function(e){c("__set_state",{addGroupLoading:!1})
var t=Number(e.base_resp.ret)
if(0===t){var r=o.addGroupForm.groupName
c("__set_state",{addGroupForm:{groupName:""},addGroupPopoverShow:!1,showLoading:!0,showSelectImg:!1}),c("resetSelectedImgs"),c("getImagesByBegin",0).then(function(e){c("__set_state",{showLoading:!1})
for(var t=e.page_info,o=!1,i=0;i<t.file_group_list.file_group.length;i++){var n=t.file_group_list.file_group[i]
if(n.name===r){a(A.SELECTED_GROUP_MUTATION,n.id),o=!0
break}}o&&(a(A.INIT_GROUPS_MUTATION,t.file_group_list.file_group),a(A.INIT_IMGS_MUTATION,[]),a(A.TOTAL_NUM_MUTATION,0),a(A.CURRENT_PAGE_MUTATION,1))}).catch(function(){c("__set_state",{showLoading:!1})})}else 15006===t?Vue.prototype.$tipsErr("已经超过100个分组，不能再创建新的分组。"):Vue.prototype.$tipsErr("创建失败，请重试")})},pageChange:function(e,t){var o=e.state,i=e.dispatch,n=e.commit,r=(t.currentPage-1)*o.perpage
n(A.CURRENT_PAGE_MUTATION,t.currentPage),i("__set_state",{showLoading:!0}),i("getImagesByBegin",r).then(function(e){i("formatData",e).then(function(){i("__set_state",{showLoading:!1}),o.imgs.forEach(function(e,t){c(o.selectedImgs,e)&&i("selectImg",{i:t,currentImg:e,forceSelect:!0})})}).catch(function(){i("__set_state",{showLoading:!1})})}).catch(function(){i("__set_state",{showLoading:!1})})},changeViewToSelectedImg:function(e){(0,e.dispatch)("__set_state",{showSelectImg:!0})},changeViewToAllImg:function(e){var t=e.dispatch
t("__set_state",{showSelectImg:!1}),t("resetSelectedImgs")},resetSelectedImgs:function(e){var t=e.state;(0,e.commit)("SELECTED_IMGS_MUTATION",t.selectedImgs.filter(function(e){return e.selected}))}}}
o.exports=a,o.exports.default=a})
define("pages/modules/media_dialog/image_dialog/mutations.js",[],function(T,_,I){"use strict"
Object.defineProperty(_,"__esModule",{value:!0})
_.INNER_STEP_MUTATION="INNER_STEP_MUTATION",_.DEFAULT_GROUP_MUTATION="DEFAULT_GROUP_MUTATION",_.WATER_STATUS_MUTATION="WATER_STATUS_MUTATION",_.INIT_IMGS_MUTATION="INIT_IMGS_MUTATION",_.UPDATE_IMGS_MUTATION="UPDATE_IMGS_MUTATION",_.ADD_IMGS_MUTATION="ADD_IMGS_MUTATION",_.REMOVE_IMGS_MUTATION="REMOVE_IMGS_MUTATION",_.UPDATE_IMG_URL_MUTATION="UPDATE_IMG_URL_MUTATION",_.INIT_GROUPS_MUTATION="INIT_GROUPS_MUTATION",_.UPDATE_GROUPS_MUTATION="UPDATE_GROUPS_MUTATION",_.SELECTED_GROUP_MUTATION="SELECTED_GROUP_MUTATION",_.SELECTED_IMGS_MUTATION="SELECTED_IMGS_MUTATION",_.UPDATE_SELECTED_IMGS_MUTATION="UPDATE_SELECTED_IMGS_MUTATION",_.ADD_SELECTED_IMGS_MUTATION="ADD_SELECTED_IMGS_MUTATION",_.REMOVE_SELECTED_IMGS_MUTATION="REMOVE_SELECTED_IMGS_MUTATION",_.UPDATE_SELECTED_IMGS_URL_MUTATION="UPDATE_SELECTED_IMGS_URL_MUTATION",_.TOTAL_NUM_MUTATION="TOTAL_NUM_MUTATION",_.CROP_IMG_MUTATION="CROP_IMG_MUTATION",_.CROP_IMG_INFO_MUTATION="CROP_IMG_INFO_MUTATION",_.CROPPER_INFO_MUTATION="CROPPER_INFO_MUTATION",_.UPDATE_COVERTING_COUNT_MUTATION="UPDATE_COVERTING_COUNT_MUTATION",_.FROM_UPLOAD_MUTATION="FROM_UPLOAD_MUTATION",_.CURRENT_PAGE_MUTATION="CURRENT_PAGE_MUTATION"})
define("pages/modules/media_dialog/image_dialog/image_dialog.tpl.js",[],function(e,i,t){return'<mp-dialog  weui="true"  ref="dialog"  :title="title"  v-model="dialogShow"  :wrap-class="crop ? \'weui-desktop-dialog_img-picker weui-desktop-dialog_img-picker-with-crop\' : \'weui-desktop-dialog_img-picker\'"  @close="close">    <mp-step v-if="crop" :step="innerStep">    <mp-step-item v-if="fromcontent" title="1 从正文选择封面"></mp-step-item>    <mp-step-item v-else title="1 选择封面"></mp-step-item>    <mp-step-item title="2 裁切封面"></mp-step-item>  </mp-step>    <template v-if="fromcontent">    <mp-image-content v-show="innerStep === 1" :img-urls="contentimgUrls" :maxselect="maxselect" :selected-imgs="selectedImgs" @select-change="contentImgChange"></mp-image-content>  </template>    <template v-else>    <div v-show="innerStep === 1" class="weui-desktop-step__panel">      <div class="weui-desktop-img-picker weui-desktop-grid">        <div class="weui-desktop-grid__item weui-desktop-img-category">          <ul class="weui-desktop-menu">            <li v-for="(group, i) in groups" class="weui-desktop-menu__item" @click="selectGroup(group.id)">              <a href="javascript:;" :class="[\'weui-desktop-menu__link\', selectedGroup === group.id ? \'weui-desktop-menu__link_current\' : \'\']">                <strong class="weui-desktop-img-category__title">{{group.name}}</strong>                <em class="weui-desktop-img-category__size">&#40;{{group.count}}&#41;</em>              </a>            </li>          </ul>          <div class="weui-desktop-img-category__add">            <mp-popover position="up-center" ref="addGroupPopover" :value="addGroupPopoverShow">              <a slot="target" href="javascript:;" @click.prevent="clickAddGroup">新建分组</a>              <div slot="content">                <mp-form ref="addGroupForm" :model="addGroupForm" weui="true" :rules="addGroupFormRules" @submit.native.prevent>                  <mp-form-item prop="groupName">                    <template slot="label">创建分组</template>                    <mp-input name="group_name" v-model="addGroupForm.groupName"  @input="groupNameInput"></mp-input>                  </mp-form-item>                </mp-form>              </div>              <div slot="bar">                <mp-button type="primary" :loading="addGroupLoading" @click="addGroup">确定</mp-button>                <mp-button type="default" @click="cancelAddGroup">取消</mp-button>              </div>            </mp-popover>          </div>        </div>        <div class="weui-desktop-grid__item">          <div class="weui-desktop-img-picker__list__area">            <div class="weui-desktop-global-mod weui-desktop-media-global-bar">              <div class="weui-desktop-global__extra">                              <mp-upload :key="selectedGroup" simple url="uploadImageLibFile" :maxfilenum="9999" extclass="weui-desktop-upload_global-media" multi :maxsize="10*1024*1024" :query="uploadQuery" :select="uploadSelect" @error="uploadError" @progress="uploadProgress" @complete="uploadComplete" @allcomplete="uploadAllComplete" :preview="null">                  <template slot="tips">                    <span class="weui-desktop-tips weui-desktop-tips_icon-after">                      <template v-if="$slots.uploadTips && $slots.uploadTips.length > 0">                        <slot name="uploadTips"></slot>，                      </template>                      {{waterStatus === 3 ? \'已关闭图片水印\' : \'已开启图片水印\'}}                      <mp-popover wrap-class="img_water" trigger="hover">                        <i class="icon-svg-common-ask" slot="target"></i>                        <div slot="content">                          <p v-if="waterStatus === 3">不添加水印</p>                          <p v-else-if="waterStatus === 2">水印类型：公众号名称</p>                          <p v-else-if="waterStatus === 1">水印类型：微信号</p>                          <p style="color: rgb(151,164,164);">                            <span v-if="waterStatus === 3">已关闭水印，所有上传的图片都不会带有水印。</span>                            <span v-else>已开启水印，所有上传的图片都会带有水印。</span>                            若需修改请前往<a target="_blank" :href="setWaterUrl">公众号设置/功能设置</a>设置图片水印                          </p>                        </div>                      </mp-popover>                    </span>                  </template>                </mp-upload>              </div>            </div>            <div class="weui-desktop-media-list-wrp weui-desktop-img-picker__list__wrp js_img-picker_wrapper" :style="dialogStyle" ref="imgPickerWrapper">              <div v-if="showLoading" class="weui-desktop-media-tips weui-desktop-media-tips_loading">加载中</div>              <div v-else-if="showSelectImg ? selectedImgs.length === 0 : imgs.length === 0" class="weui-desktop-media-tips">暂无数据</div>              <ul v-else class="weui-desktop-img-picker__list">                <template v-if="showSelectImg">                  <li v-for="(img, i) in selectedImgs" v-if="i < perpage" :key="img.fileId" :class="[\'weui-desktop-img-picker__item\', { selected : img.selected }]" @click.stop.prevent="selectImg({i: i, currentImg: img})">                    <template v-if="!img.loading && !img.msg">                      <i role="img" aria-describedby="图片描述" title="图片描述" class="weui-desktop-img-picker__img-thumb" :style="img.url?\'background-image:url(\' + img.url + \');\':\'\'">                        <span v-show="maxSelect > 1" :class="[\'image_dialog__checkbox\', img.selected ? \'selected\' : \'\']"></span>                      </i>                      <strong class="weui-desktop-img-picker__img-title"><i v-if="img.copyright_status === 2" class="icon_original accessed"></i>{{img.name}}</strong>                    </template>                  </li>                </template>                <template v-if="!showSelectImg">                  <li v-for="(img, i) in imgs" v-if="i < perpage" :key="img.fileId" :class="[\'weui-desktop-img-picker__item\', { selected : img.selected, disabled: !img.selected && !canSelect }]" @click.stop.prevent="selectImg({i: i, currentImg: img})">                    <mp-upload-item v-if="img.loading || img.msg" :file="img" @remove="removeImgItem(img, i)"></mp-upload-item>                    <template v-if="!img.loading && !img.msg">                      <i role="img" aria-describedby="图片描述" title="图片描述" class="weui-desktop-img-picker__img-thumb" :style="img.url?\'background-image:url(\' + img.url + \');\':\'\'">                        <span v-show="maxSelect > 1" :class="[\'image_dialog__checkbox\', img.selected ? \'selected\' : \'\']"></span>                      </i>                      <strong class="weui-desktop-img-picker__img-title"><i v-if="img.copyright_status === 2" class="icon_original accessed"></i>{{img.name}}</strong>                    </template>                  </li>                </template>              </ul>            </div>            <mp-pagination v-if="!showSelectImg" :total-num="totalnum" :per-page="perpage" :current="currentPage" @page-change="pageChange"></mp-pagination>          </div>        </div>      </div>    </div>  </template>    <div v-if="crop && innerStep === 2" class="weui-desktop-step__panel">    <mp-image-crop v-if="innerStep === 2" :src="cropImg.url" :ratio="ratio" :crop-info="cropperInfo" :should-hide-ratio-tabs="shouldHideRatioTabs" @change="cropChange">          </mp-image-crop>  </div>  <template slot="footer">    <div v-if="!fromcontent && innerStep === 1 && maxSelect > 1" class="weui-desktop-img-picker__counter">      <span>已选择 <a href="javascript:" @click="changeViewToSelectedImg">{{selectedImgs | getSelectedImgLength}} / {{maxSelect}}  项</a></span>      <span v-if="showSelectImg"><a href="javascript:" @click="changeViewToAllImg">返回全部</a></span>    </div>    <mp-button v-show="innerStep === 1" type="primary" :disabled="disable" :loading="btnLoading" @click="ok">{{ crop ? \'下一步\' : \'确定\' }}</mp-button>    <mp-button v-if="!crop" @click="close">取消</mp-button>    <mp-button v-show="innerStep === 2" @click="prevStep">上一步</mp-button>    <mp-button v-show="innerStep === 2" type="primary" @click="ok">完成</mp-button>  </template></mp-dialog>'})
define("pages/editor/ad_insert_statement_dialog.js",["pages/modules/media_dialog/ad_insert_statement_dialog/ad_insert_statement_dialog.js"],function(t,e,a){"use strict"
function s(){return{show:!1}}t("pages/modules/media_dialog/ad_insert_statement_dialog/ad_insert_statement_dialog.js"),a.exports={getParams:s,bindEvent:function(n){n.eventBus.$on("showAdInsertStatementDialog",function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e={show:!1}
for(var a in t)void 0!==e[a]&&(e[a]=t[a])
for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n.params[s]=e[s])
n.params.show=!0})},close:function(t){t.params.show=!1}}})
define("pages/modules/media_dialog/ad_insert_statement_dialog/ad_insert_statement_dialog.js",["pages/modules/media_dialog/ad_insert_statement_dialog/ad_insert_statement_dialog.css.js","pages/modules/media_dialog/ad_insert_statement_dialog/ad_insert_statement_dialog.tpl.js"],function(e,t,a){"use strict"
e("pages/modules/media_dialog/ad_insert_statement_dialog/ad_insert_statement_dialog.css.js")
var s=e("pages/modules/media_dialog/ad_insert_statement_dialog/ad_insert_statement_dialog.tpl.js")
Vue.component("mp-ad-insert-statement-dialog",{template:s,props:{show:{type:Boolean,default:!0}},methods:{close:function(){this.$emit("close")}}})})
define("pages/modules/media_dialog/ad_insert_statement_dialog/ad_insert_statement_dialog.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.ad-insert-statement-dialog .weui-desktop-dialog__wrp {  min-height: 750px;}.ad-insert-statement-dialog .ad-insert-statement {  text-align: center;  padding: 150px 0 150px;}.ad-insert-statement-dialog .ad-insert-statement .weui-desktop-msg__desc-wrp {  text-align: inherit;}";});define("pages/modules/media_dialog/ad_insert_statement_dialog/ad_insert_statement_dialog.tpl.js",[],function(e,t,s){return'<div>    <mp-dialog weui="true" class="ad-insert-statement-dialog" :value="show" :width="726" :height="638"   title="插入广告" @close="close">    <template>      <div class="ad-insert-statement weui-desktop-msg__inner">        <span class="weui-desktop-msg__hd">          <i class="weui-desktop-icon-info weui-desktop-icon_msg"></i>        </span>        <div class="weui-desktop-msg__bd">          <h4 class="weui-desktop-msg__title">文中智能插入支持插入2条广告</h4>          <div class="weui-desktop-msg__desc-wrp">            <div class="weui-desktop-msg__desc">群发后系统将根据文章长度智能地选择位置插入1~2条广告</div>          </div>        </div>        </div>    </template>    <template slot="footer">      <mp-button type="primary" @click="close">确定</mp-button>      <mp-button @click="close">取消</mp-button>    </template>  </mp-dialog></div>'})
define("pages/editor/templateDialog4Web1.js",["pages/modules/media_dialog/template_dialog/template_dialog.js"],function(e,a,t){"use strict"
function l(){return{isShow:!1}}e("pages/modules/media_dialog/template_dialog/template_dialog.js"),t.exports={getParams:l,bindEvent:function(i){i.eventBus.$on("showTemplateDialog",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=l()
for(var t in e)void 0!==a[t]&&(a[t]=e[t])
for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i.params[o]=a[o])
i.params.isShow=!0})},close:function(e){e.eventBus.$emit("showTemplateDialog_callback",e.data)}}})
define("pages/modules/media_dialog/template_dialog/template_dialog.js",["vue-weui/src/dialog/dialog.js","vue-weui/src/pagination/pagination.js","pages/modules/media/templatemsg/templatemsg.js","pages/modules/media_dialog/template_dialog/template_dialog.css.js","pages/modules/media_dialog/template_dialog/template_dialog.tpl.js","pages/modules/utils/cgi.js","pages/modules/media_dialog/template_dialog/template_common.js"],function(e,t,i){"use strict"
e("vue-weui/src/dialog/dialog.js"),e("vue-weui/src/pagination/pagination.js"),e("pages/modules/media/templatemsg/templatemsg.js"),e("pages/modules/media_dialog/template_dialog/template_dialog.css.js")
var a=e("pages/modules/media_dialog/template_dialog/template_dialog.tpl.js"),s=e("pages/modules/utils/cgi.js"),o=e("pages/modules/media_dialog/template_dialog/template_common.js")
Vue.component("mp-template-dialog",{template:a,props:{value:{type:Boolean,default:!1}},data:function(){return{dialogShow:!1,dialogTitle:"插入模版",loading:!1,pageConf:{pageLen:4,totalNum:0,currentPage:1},selectedTemplate:null,msg:null,list:[],itemHeight:238,dialogHeight:0,lastHeight:0,height:0}},mounted:function(){var e=this
!0===this.value&&this.show()
var t=this.$refs.templateDialog,i=t&&t.$refs.main,a=i&&i.querySelector(".weui-desktop-dialog")
this.dialogHeight=function(e,t){if(!e)return 0;(e=e.cloneNode(!0)).style.visibility="hidden",document.body.appendChild(e)
var i=0,a=e.offsetHeight
return i+=t?parseInt(window.getComputedStyle(e).marginTop,10)+parseInt(window.getComputedStyle(e).marginBottom,10)+a:a,document.body.removeChild(e),e.style.visibility="visible",i}(a),this.needResize(),this.pageChange({currentPage:1})
var s=this
window.addEventListener("resize",function(){s.timer&&clearTimeout(s.timer),s.timer=setTimeout(function(){s.needResize()&&e.pageChange({currentPage:e.pageConf.currentPage})},250)})},watch:{value:function(e){!0===e?this.show():this.hide()},dialogShow:function(e){this.$emit("input",e)}},methods:{show:function(){!1===this.dialogShow&&(this.dialogShow=!0)},hide:function(){!0===this.dialogShow&&(this.dialogShow=!1)},closeDialog:function(){this.hide(),this.$emit("cancel")},getTemplateData:function(e){var a=this
return this.loading=!0,new Promise(function(t,i){s.post({url:"/cgi-bin/appmsgtemplate?action=list",data:{begin:e*a.pageConf.pageLen,count:a.pageConf.pageLen},mask:!1},function(e){(e&&e.base_resp&&0===e.base_resp.ret?t:i)(e)},function(){i({code:-1})})})},pageChangeSucCb:function(e){var t=e.appmsg_template||[]
if(0===t.length)return!(this.msg="暂无数据")
var i=+e.total
return this.pageConf.totalNum=i,o.formatTemplateData(t,{canSelect:!0,canPreview:!1,showUpdateTime:!0,showEdit:!1,highLine:!1}),this.list=t,!(this.loading=!1)},pageChangeErrCb:function(e){if(this.loading=!1,e&&e.base_resp)switch(e.base_resp.ret){case 200013:this.msg="操作太频繁，请稍后再试"
break
default:this.msg=""}e&&0!==e.code&&(this.msg="系统繁忙，请稍后再试")},pageChange:function(e){var t=this,i=e.currentPage,a=0<=(this.pageConf.currentPage=i)-1?i-1:0
this.getTemplateData(a).then(function(e){t.pageChangeSucCb(e)}).catch(function(e){t.pageChangeErrCb(e)})},selectTemplate:function(e){this.selectedTemplate=e},submit:function(){this.$emit("select",{content:this.selectedTemplate&&this.selectedTemplate.content?this.selectedTemplate.content:""}),this.hide()},needResize:function(){var e=!1,t=window.innerHeight-this.dialogHeight,i=Math.floor(t/this.itemHeight)
return i=i<2?2:i,t/this.itemHeight-i!=0&&(t=this.itemHeight*i),t!==this.lastHeight&&(e=!0),this.pageConf.pageLen=2*i,this.lastHeight=t,this.height=t+"px",e},reportManageClick:function(){(new Image).src="//mp.weixin.qq.com/mp/jsmonitor?idkey=122333_83_1&t="+Math.random()}}})})
define("pages/modules/media/templatemsg/templatemsg.js",["pages/modules/media/templatemsg/templatemsg.tpl.js"],function(e,t,m){"use strict"
var s=e("pages/modules/media/templatemsg/templatemsg.tpl.js")
Vue.component("mp-template-msg",{template:s,props:{item:{type:Object,default:function(){return{}}},selectedTemplate:{type:Object,default:function(){return{}}}},computed:{isSelected:function(){return this.selectedTemplate&&this.item.appmsgid===this.selectedTemplate.appmsgid?"display:block":""}},methods:{choose:function(){this.$emit("click",this.item)}}})})
