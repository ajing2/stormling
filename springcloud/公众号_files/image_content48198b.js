define("pages/modules/media_dialog/blockquote_dialog/blockquote_dialog.js",["pages/modules/media_dialog/blockquote_dialog/blockquote_dialog.css.js","vue-weui/src/dialog/dialog.js","vue-weui/src/pagination/pagination.js","vue-weui/src/tab/tab.js","vue-weui/src/search/search.js","vue-weui/src/form/form.js","vue-weui/src/form/form_item.js","vue-weui/src/input/input.js","vue-weui/src/radio/radio.js","vue-weui/src/radio/radio_group.js","pages/modules/utils/str_util.js","3rd/editor/common/monitor.js","pages/modules/media_dialog/blockquote_dialog/blockquote_dialog.tpl.js","pages/modules/utils/object.js","pages/modules/utils/time.js","pages/modules/utils/cgi.js"],function(e,t,i){"use strict"
e("pages/modules/media_dialog/blockquote_dialog/blockquote_dialog.css.js"),e("vue-weui/src/dialog/dialog.js"),e("vue-weui/src/pagination/pagination.js"),e("vue-weui/src/tab/tab.js"),e("vue-weui/src/search/search.js"),e("vue-weui/src/form/form.js"),e("vue-weui/src/form/form_item.js"),e("vue-weui/src/input/input.js"),e("vue-weui/src/radio/radio.js"),e("vue-weui/src/radio/radio_group.js")
var r=e("pages/modules/utils/str_util.js"),a=e("3rd/editor/common/monitor.js"),s=e("pages/modules/media_dialog/blockquote_dialog/blockquote_dialog.tpl.js"),o=e("pages/modules/utils/object.js").assign,n=e("pages/modules/utils/time.js").formatDate,d=e("pages/modules/utils/cgi.js"),l={tab:"inner",source:"url",digest:"",digestError:"",from:"",search:{url:{data:"",loading:null,error:"",result:null},biz:{data:"",loading:null,error:"",result:[],pagination:{total:0,current:0}},article:{data:"",loading:null,result:[],pagination:{total:0,current:0,showJumper:!0,showEndpage:!0}}},chooseUrlIdx:null,chooseBizIdx:null,chooseArticleIdx:null,can_use_new_search:window.wx&&window.wx.cgiData&&window.wx.cgiData.can_use_new_search||0,articleCacheData:{},showPageMap:[],noKey:"__mpnokey",editorReportData:{innerClick:{id:"122333",key:"75",len:0},outClick:{id:"122333",key:"76",len:0},urlClick:{id:"122333",key:"77",len:0},bizClick:{id:"122333",key:"78",len:0}}}
Vue.component("mp-blockquote-dialog",{template:s,props:{title:{type:String,default:""},value:{type:Boolean,default:!1},text:{type:String,default:""},dataset:{type:Object,default:function(){}},hasReportOverSize:{type:Boolean,default:!1}},data:function(){return o({defaultBizAvatar:window.wx.cgiData.defaultBizAvatar,tabs:[{id:"inner",name:"公众号文章",url:"",show:!0},{id:"out",name:"外部内容",url:"",show:!0}],dialogShow:!1},JSON.parse(JSON.stringify(l)))},computed:{confirmDisabled:function(){if(""===this.digest&&""===this.text||300<this.digest.length)return!0
if("inner"===this.tab)switch(this.source){case"url":if(null===this.chooseUrlIdx)return!0
break
case"biz":if(null===this.chooseArticleIdx)return!0
break
default:return!0}return!1}},watch:{dialogShow:function(e){this.$emit("input",e)},value:function(e){!0===e?this.show():this.hide()},dataset:function(e){void 0!==e.type&&("1"===e.type?(this.tab="inner",this.search.url.data=e.url,this.searchUrl()):(this.tab="out",this.from=e.sourceTitle))},source:function(e){var t=this.editorReportData[e+"Click"]
t&&t.len++}},filters:{formatDate:function(e){return n(e,"YYYY-MM-DD")}},methods:{getEditorReportData:function(){var e=[]
for(var t in this.editorReportData)if(Object.prototype.hasOwnProperty.call(this.editorReportData,t)){var i=this.editorReportData[t]
0<i.len&&e.push({id:i.id,key:i.key,len:i.len})}return e},show:function(){!0!==this.dialogShow&&(this.initData(),this.dialogShow=!0)},hide:function(){!1!==this.dialogShow&&(this.dialogShow=!1)},dialogClose:function(){this.hide(),this.$emit("cancel",{hasReportOverSize:this.hasReportOverSize,editorReportData:this.getEditorReportData()})},initData:function(){for(var e in o(this,JSON.parse(JSON.stringify(l))),this.innerSearchUrl="",this.innerSearchBiz="",this.innerSearchArticle="",this.editorReportData)Object.prototype.hasOwnProperty.call(this.editorReportData,e)&&(this.editorReportData[e].len=0)},tabChange:function(e){this.tab=e
var t=this.editorReportData[e+"Click"]
t&&t.len++},digestInput:function(){var e=this;(this.digestError="")===this.digest?this.$nextTick(function(){e.digestError="请输入引用文本"}):300<this.digest.length&&(this.hasReportOverSize||(a.setSum(69271,37,1),this.hasReportOverSize=!0),this.$nextTick(function(){e.digestError="为避免不合理引用而产生侵权风险，单次引用字数不得超过300字"}))},searchUrl:function(){var t=this,i=this.search.url
this.innerSearchUrl!==i.data&&(i.error="",i.result=null,this.innerSearchUrl=i.data,""!==i.data&&/^https?:\/\/mp\.weixin\.qq\.com.*/.test(i.data)?(i.loading=!0,d.get({url:"/cgi-bin/quotecgi?action=geturlinfo",data:{url:this.innerSearchUrl}},function(e){if(e&&e.base_resp)switch(e.base_resp.ret){case 0:delete e.base_resp,t.chooseUrlIdx=0,i.result=e
break
case 17987001:case 17987002:i.error="未找到相应的文章链接"
break
case 17987003:i.error="请输入已群发的公众号文章链接"
break
case 17987004:i.error="付费文章不可被引用"
break
default:i.error="系统错误，请稍候重试",t.innerSearchUrl=""}else i.error="系统错误，请稍候重试",t.innerSearchUrl=""
i.loading=!1},function(){i.error="系统错误，请稍候重试",t.innerSearchUrl="",i.loading=!1})):this.$nextTick(function(){i.error="请输入以 https://mp.weixin.qq.com 开头的正确的公众号文章链接"}))},searchBiz:function(){var e=this.search.biz
""!==e.data?this.renderBizData(e.data):e.error="请输入文章所属公众号的名称"},chooseBiz:function(e){this.chooseBizIdx=e,this.search.article.data="",this.searchArticle()},searchArticle:function(e){var t=0<arguments.length&&void 0!==e?e:""
this.chooseArticleIdx=null,this.renderArticleData(t)},confirm:function(){var e={type:this.tab,source:this.source,digest:this.digest,digestLen:this.digest.length||this.text.length,text:this.text,article:{},hasReportOverSize:this.hasReportOverSize,editorReportData:this.getEditorReportData()}
if(""===e.text&&(e.digest="<p>"+r.html(e.digest,!0)+"</p>"),"inner"===e.type)if("url"===e.source){var t=this.search.url.result
e.article={title:t.title,url:t.url,nickname:t.nickname,authorName:t.author_name}}else{var i=this.search.biz.result[this.chooseBizIdx],a=this.search.article.result[this.chooseArticleIdx]
e.article={title:a.title.replace(/<\/?em>/g,""),url:a.link,nickname:i.nickname,authorName:a.author_name}}else e.from=this.from
this.$emit("select",JSON.parse(JSON.stringify(e))),this.hide()},bizPageChange:function(e){var t=e.currentPage
this.renderBizData(this.innerSearchBiz,t)},articlePageChange:function(e){var t=e.currentPage
this.chooseArticleIdx=null
var i=t
this.can_use_new_search&&this.innerSearchArticle&&(this.showPageMap[t-1]?i=this.showPageMap[t-1].requestPage:this.showPageMap[t-2]&&(i=this.showPageMap[t-2].requestPage+1)),this.renderArticleData(this.innerSearchArticle,i)},renderBizData:function(e,t,i){var a=1<arguments.length&&void 0!==t?t:1,r=2<arguments.length&&void 0!==i?i:3
this.innerSearchBiz=e
var s=this.search.biz
s.error="",s.result=[],s.loading=!0,d.get({url:"/cgi-bin/searchbiz?action=search_biz",data:{query:e,begin:(a-1)*r,count:r}},function(e){if(e&&e.base_resp)switch(e.base_resp.ret){case 0:s.result=e.list,s.pagination={total:e.total,current:a}
break
default:s.error="系统错误，请稍候重试"}else s.error="系统错误，请稍候重试"
s.loading=!1},function(){s.error="系统错误，请稍候重试",s.loading=!1})},renderNewArticleData:function(a,e,t){var r=this,s=1<arguments.length&&void 0!==e?e:1,o=2<arguments.length&&void 0!==t?t:5,n=this.search.article
if(!n.loading){var l=""
l=this.innerSearchArticle!==a||n.pagination.current<=s?"next":"pre",this.innerSearchArticle=a,n.result=[],n.loading=!0
var c=this.search.biz.result[this.chooseBizIdx].fakeid||this.noKey,h=encodeURIComponent(this.innerSearchArticle||this.noKey),i=function(e){if(n.loading=!1,e&&e.base_resp)switch(e.base_resp.ret){case 0:r.articleCacheData[c]||(r.articleCacheData[c]={}),r.articleCacheData[c][h]||(r.articleCacheData[c][h]={})
var t=!0
if(r.articleCacheData[c][h][s]||(t=!(r.articleCacheData[c][h][s]={resp:e,showPage:null})),e.app_msg_list&&0!==e.app_msg_list.length||!("next"===l&&e.app_msg_cnt>s*o||"pre"===l&&1<=s-1))t||(r.showPageMap.push({requestPage:s}),r.articleCacheData[c][h][s].showPage=r.showPageMap.length-1),n.result=e.app_msg_list,n.pagination={total:e.app_msg_cnt,current:s,showJumper:!1,showEndpage:!1}
else{var i="next"===l?s+1:s-1
r.renderNewArticleData(a,i,o)}break
case 200013:r.$tipsErr("操作太频繁，请稍后再试")
break
default:r.$tipsErr("系统错误，请稍候重试")}else r.$tipsErr("系统错误，请稍候重试")},u=null
this.articleCacheData[c]&&this.articleCacheData[c][h]&&this.articleCacheData[c][h][s]&&(u=this.articleCacheData[c][h][s].resp),u?i(u):d.get({url:"/cgi-bin/appmsg?action=list_ex",data:{fakeid:this.search.biz.result[this.chooseBizIdx].fakeid,query:a,begin:(s-1)*o,count:o,type:9,need_author_name:1}},i,function(){r.$tipsErr("系统错误，请稍候重试"),n.loading=null})}},renderArticleData:function(e,t,i){var a=this,r=1<arguments.length&&void 0!==t?t:1,s=2<arguments.length&&void 0!==i?i:4,o=this.search.article
o.loading||(this.can_use_new_search&&e?this.renderNewArticleData(e,r,s):(this.innerSearchArticle=e,o.result=[],o.loading=!0,d.get({url:"/cgi-bin/appmsg?action=list_ex",data:{fakeid:this.search.biz.result[this.chooseBizIdx].fakeid,query:e,begin:(r-1)*s,count:s,type:9,need_author_name:1}},function(e){if(o.loading=!1,e&&e.base_resp)switch(e.base_resp.ret){case 0:o.result=e.app_msg_list,o.pagination={total:e.app_msg_cnt,current:r,showJumper:!0,showEndpage:!0}
break
case 200013:a.$tipsErr("操作太频繁，请稍后再试")
break
default:a.$tipsErr("系统错误，请稍候重试")}else a.$tipsErr("系统错误，请稍候重试")},function(){a.$tipsErr("系统错误，请稍候重试"),o.loading=null})))}}})})
define("pages/modules/media_dialog/blockquote_dialog/blockquote_dialog.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.quote_wrp {  padding: 30px;}.quote_wrp .weui-desktop-form__textarea {  min-height: 100px;}.quote_wrp .weui-desktop-media__list-wrp {  height: 188px;}.quote_article_table {  margin-top: 20px;}.quote_article_table th {  padding-top: 9px;  padding-bottom: 9px;}.quote_article_table .weui-desktop-table__check-cell .weui-desktop-form__check-label {  visibility: visible;  opacity: 1;}.quote_article_title {  font-weight: 400;  overflow: hidden;  text-overflow: ellipsis;  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-line-clamp: 1;  color: #353535;}.quote_article_title em {  font-style: normal;  color: #07C160;}.quote_article_nickname {  displya: inline-block;  vertical-align: middle;  width: 10em;  overflow: hidden;  text-overflow: ellipsis;  white-space: nowrap;  word-wrap: normal;}.quote_article_area .weui-desktop-search {  margin-bottom: 20px;}.weui-desktop-media__list-wrp {  border: 1px solid #E4E8EB;}.quote_article_item {  display: block;  border-bottom: 1px solid #E4E8EB;}.quote_article_item:last-child {  border-bottom: 0;}.quote_account_item,.quote_article_item {  padding: 12px;  cursor: pointer;}.quote_account_nickname {  font-weight: 400;  margin-left: 1em;  display: inline-block;  vertical-align: middle;  width: 7em;  overflow: hidden;  text-overflow: ellipsis;  white-space: nowrap;  word-wrap: normal;}.quote_account_wechat {  font-style: normal;  margin-left: 1em;  color: #9A9A9A;}.quote_account_avatar {  width: 36px;  height: 36px;  vertical-align: middle;  -webkit-border-radius: 50px;  border-radius: 50px;}.quote_account_type {  color: #9A9A9A;}.quote_account_msg .weui-desktop-link-btn {  vertical-align: baseline;  margin-left: 1em;}.quote_article_item .weui-desktop-form__check-label {  margin-top: -4px;}.quote_article_date {  color: #9A9A9A;}.quote_tips {  color: #9A9A9A;  padding: 20px 30px 0;}.weui-desktop-key-tag_pay {  float: left;  background-color: #FA9D3B;  color: #fff;  margin-top: 2px;}";});define("pages/modules/media_dialog/blockquote_dialog/blockquote_dialog.tpl.js",[],function(e,a,t){return'<mp-dialog weui="true" v-model="dialogShow" :title="title" wrap-class="weui-desktop-video-dialog" @close="dialogClose">  <mp-tab class="weui-desktop-tab_dialog" :tabs="tabs" :selected="tab" @click="tabChange"></mp-tab>    <div class="quote_wrp">    <div class="quote_inner">      <mp-form-item>        <template slot="label">引用文本</template>        <mp-input v-if="text === \'\'" :multi="true" :countable="true" :maxlength="300" v-model="digest" filter="trim" placeholder="输入引用文本（300字以内）" @input="digestInput" :status="digestError ? \'warn\' : \'normal\'">          <template slot="message">{{ digestError }}</template>        </mp-input>        <mp-input v-else :multi="true" v-model="text" disabled></mp-input>      </mp-form-item>            <template v-if="tab === \'inner\'">        <mp-form-item class="weui-desktop-form__control-group_offset">          <template slot="label">查找来源</template>          <mp-radio-group v-model="source">            <mp-radio value="url">输入文章地址</mp-radio>            <mp-radio value="biz">查找公众号文章</mp-radio>          </mp-radio-group>        </mp-form-item>        <div class="quote_article_area">                    <div class="quote_article_area_inner" v-if="source === \'url\'">            <mp-form-item>              <template slot="label">文章链接</template>              <template>                <mp-input filter="trim" v-model.trim="search.url.data" placeholder="输入引用文本所属公众号文章链接" @input="searchUrl" :status="search.url.error ? \'warn\' : \'normal\'">                  <template slot="message">{{ search.url.error }}</template>                </mp-input>                <div class="weui-desktop-table__wrp quote_article_table" v-if="search.url.loading !== null && !search.url.error">                  <table class="weui-desktop-table">                    <thead class="weui-desktop-table__hd">                      <tr>                        <th class="weui-desktop-table__check-cell"></th>                        <th>文章</th>                        <th>公众号</th>                      </tr>                    </thead>                    <tbody class="weui-desktop-table__bd">                      <tr v-if="search.url.loading">                        <td colspan="3" loading="true">                          <i class="weui-desktop-loading">加载中</i>                        </td>                      </tr>                      <tr v-else-if="search.url.result === null">                        <td colspan="3" empty="true">暂无数据</td>                      </tr>                      <tr v-else>                        <td class="weui-desktop-table__check-cell">                          <mp-radio-group v-model="chooseUrlIdx">                            <mp-radio :value="0"></mp-radio>                          </mp-radio-group>                        </td>                        <td>                          <a :href="search.url.result.url" target="_blank" class="quote_article_title">{{ search.url.result.title }}</a>                        </td>                        <td>                          <div class="quote_article_nickname">{{ search.url.result.nickname }}</div>                        </td>                      </tr>                    </tbody>                  </table>                </div>              </template>            </mp-form-item>          </div>                    <div class="quote_article_area_inner" v-else>            <mp-form-item>              <template slot="label">公众号</template>              <template>                                <div class="quote_account_area quote_account_area_account" v-if="chooseBizIdx === null">                  <mp-search filter="trim" placeholder="输入引用文章所属的公众号名称或微信号" v-model.trim="search.biz.data" @search="searchBiz" @input="search.biz.error = \'\', search.biz.loading = null" :status="search.biz.error ? \'warn\' : \'normal\'">                    <template v-if="search.biz.error" slot="message">{{ search.biz.error }}</template>                  </mp-search>                  <div v-if="search.biz.loading !== null && !search.biz.error" class="weui-desktop-media__list-wrp">                    <div v-if="search.biz.loading" class="weui-desktop-media-tips"><i class="weui-desktop-loading"></i></div>                    <ul v-else-if="search.biz.result.length" class="quote_account_list">                      <li class="quote_account_item" v-for="(biz, bizIdx) in search.biz.result" @click="chooseBiz(bizIdx)">                        <div class="weui-desktop-vm_primary">                          <img class="quote_account_avatar" :src="biz.round_head_img || defaultBizAvatar">                          <strong class="quote_account_nickname">{{ biz.nickname }}</strong>                          <i class="quote_account_wechat">微信号：{{ biz.alias || \'未设置\' }}</i>                        </div>                        <div class="weui-desktop-vm_default quote_account_type">{{ biz.service_type === 0 ? \'订阅号\' : \'服务号\' }}</div>                      </li>                    </ul>                    <div v-else class="weui-desktop-media-tips">暂无数据</div>                  </div>                  <mp-pagination v-if="search.biz.loading !== null && !search.biz.error && !search.biz.loading && search.biz.result.length" :total-num="search.biz.pagination.total" :per-page="3" :current="search.biz.pagination.current" @page-change="bizPageChange"></mp-pagination>                </div>                                <div class="quote_account_area quote_account_area_article" v-else>                  <p class="quote_account_msg">                    {{ search.biz.result[chooseBizIdx].nickname }}<mp-button class="weui-desktop-link-btn weui-desktop-link" @click="chooseBizIdx = null, chooseArticleIdx = null, search.biz.data = \'\', search.biz.loading = null">重新搜索</mp-button>                  </p>                  <mp-search filter="trim" placeholder="输入文章名查找公众号群发过的文章" v-model.trim="search.article.data" @search="searchArticle"></mp-search>                  <div v-if="search.article.loading !== null" class="weui-desktop-media__list-wrp">                    <div v-if="search.article.loading" class="weui-desktop-media-tips"><i class="weui-desktop-loading"></i></div>                    <div v-else-if="search.article.result.length" class="quote_article_list">                      <mp-radio-group v-model="chooseArticleIdx">                        <label class="quote_article_item" v-for="(article, articleIdx) in search.article.result">                          <span class="weui-desktop-vm_default">                            <mp-radio :value="articleIdx" :disabled="article.is_pay_subscribe === 1"></mp-radio>                          </span>                          <span class="weui-desktop-vm_primary">                            <span v-if="article.is_pay_subscribe" class="weui-desktop-key-tag weui-desktop-key-tag_pay">付费</span>                            <a :href="article.link" target="_blank" class="quote_article_title" v-html="article.title"></a>                          </span>                          <span class="weui-desktop-vm_default quote_article_date">{{ article.update_time | formatDate }}</span>                        </label>                      </mp-radio-group>                    </div>                    <div v-else class="weui-desktop-media-tips">暂无数据</div>                  </div>                  <mp-pagination v-if="search.article.loading !== null && !search.article.loading && search.article.result.length" :total-num="search.article.pagination.total" :per-page="4" :current="search.article.pagination.current" :show-jumper="search.article.pagination.showJumper" :show-endpage="search.article.pagination.showEndpage" @page-change="articlePageChange"></mp-pagination>                </div>              </template>            </mp-form-item>          </div>        </div>      </template>            <template v-else>        <mp-form-item>          <template slot="label">引用来源</template>          <mp-input filter="trim" placeholder="输入外部内容来源信息：作者，来源等（选填）" v-model="from"></mp-input>        </mp-form-item>      </template>    </div>  </div>  <template slot="footer">    <mp-button type="primary" :disabled="confirmDisabled" @click="confirm">确定</mp-button>    <mp-button @click="dialogClose">取消</mp-button>  </template></mp-dialog>'})
define("pages/modules/media_dialog/image_dialog/imageDialog4Web1.js",["pages/modules/media_dialog/image_dialog/image_dialog.js"],function(e,a,o){"use strict"
function n(){return{title:"选择图片",maxselect:1,uploadscene:0,uploadgroup:1,fromcontent:!1,contentimgUrls:[],scene:"cdn",desc:"",step:1,crop:!1,ratio:[{title:"图文封面",ratio:1}],cropInfo:[],src:"",defaultshow:!1}}e("pages/modules/media_dialog/image_dialog/image_dialog.js"),o.exports={getParams:n,bindEvent:function(t){t.eventBus.$on("showImageDialog",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=n()
for(var o in e)void 0!==a[o]&&(a[o]=e[o])
for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t.params[i]=a[i])
t.params.defaultshow=!0}),t.eventBus.$on("hideImageDialog",function(e){t.params.defaultshow=!e})},close:function(e){e.eventBus.$emit("showImageDialog_callback",e.data)}}})
define("pages/modules/media_dialog/image_dialog/image_dialog.js",["vue-weui/src/pagination/pagination.js","vue-weui/src/popover/popover.js","vue-weui/src/step/step.js","vue-weui/src/step/step_item.js","vue-weui/src/form/form.js","vue-weui/src/form/form_item.js","vue-weui/src/input/input.js","pages/modules/upload/item.js","pages/modules/upload/upload.js","pages/modules/media_dialog/common/media_dialog.css.js","pages/modules/media_dialog/image_dialog/image_dialog.css.js","pages/modules/media_dialog/image_dialog/image_crop.js","pages/modules/media_dialog/image_dialog/image_content.js","3rd/vuex/vuex.min.js","pages/modules/media_dialog/image_dialog/image_dialog_store.js","pages/modules/media_dialog/image_dialog/image_dialog.tpl.js"],function(e,t,i){"use strict"
var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]
for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e}
e("vue-weui/src/pagination/pagination.js"),e("vue-weui/src/popover/popover.js"),e("vue-weui/src/step/step.js"),e("vue-weui/src/step/step_item.js"),e("vue-weui/src/form/form.js"),e("vue-weui/src/form/form_item.js"),e("vue-weui/src/input/input.js"),e("pages/modules/upload/item.js"),e("pages/modules/upload/upload.js"),e("pages/modules/media_dialog/common/media_dialog.css.js"),e("pages/modules/media_dialog/image_dialog/image_dialog.css.js"),e("pages/modules/media_dialog/image_dialog/image_crop.js"),e("pages/modules/media_dialog/image_dialog/image_content.js")
var o=e("3rd/vuex/vuex.min.js"),n=e("pages/modules/media_dialog/image_dialog/image_dialog_store.js"),r=e("pages/modules/media_dialog/image_dialog/image_dialog.tpl.js"),a=(0,o.createNamespacedHelpers)(n.moduleName),u=a.mapState,g=a.mapActions
function l(e,t){if(!e)return 0;(e=e.cloneNode(!0)).style.visibility="hidden",document.body.appendChild(e)
var i=0,o=e.offsetHeight
t?i+=parseInt(window.getComputedStyle(e).marginTop,10)+parseInt(window.getComputedStyle(e).marginBottom,10)+o:i+=o
return document.body.removeChild(e),e.style.visibility="visible",i}function c(e,t){var i=-1
return 0<=e.length&&(i=function(e,t){for(var i=0,o=e.length;i<o;++i)if(String(e[i].fileId)===String(t))return i
return-1}(e,t.fileId)),-1!==i}Vue.component("mp-image-dialog",{template:r,model:{prop:"value",event:"visible-change"},props:{value:{type:Boolean,default:!1},title:{type:String,default:"选择图片"},scene:{type:String,default:"cdn"},maxselect:{type:Number,default:1},defaultgroup:{type:Number,default:0},fromcontent:{type:Boolean,default:!1},contentimgUrls:{type:Array,default:function(){return[]}},uploadscene:{type:Number,default:0},uploadgroup:{type:Number,default:1},defaultshow:{type:Boolean,default:!1},step:{type:Number,default:1},crop:{type:Boolean,default:!1},ratio:{type:Array,default:function(){return[{title:"图文封面",ratio:1}]}},cropInfo:{type:Array,default:function(){return[]}},src:{type:String,default:""},shouldHideRatioTabs:{type:Boolean,default:!1}},data:function(){return{setWaterUrl:"/cgi-bin/settingpage?t=setting/function&action=function&set_water=1",dialogShow:this.value,imgItemHeight:158,oriListHeight:0,lastListHeight:0,dialogStyle:{height:""},curPerpage:12,addGroupFormRules:{groupName:[{required:!0,message:"分组名为1-6个字符",trigger:"blur"},{max:6,message:"分组名为1-6个字符",trigger:["change","blur"]}]},uploadSuccessNum:0}},computed:s({disable:function(){return this.selectedImgs.filter(function(e){return e.selected}).length<=0},canSelect:function(){return this.selectedImgs.length<this.maxSelect||1===this.maxSelect},uploadQuery:function(){var e={writetype:"doublewrite",groupid:this.selectedGroup?this.selectedGroup:this.uploadgroup}
return this.uploadscene&&(e.scene=this.uploadscene),e}},u(["innerStep","currentPage","perpage","maxSelect","waterStatus","imgs","groups","selectedGroup","selectedImgs","totalnum","cropImg","cropImgInfo","cropperInfo","showLoading","fromUpload","addGroupForm","addGroupPopoverShow","btnLoading","addGroupLoading","groupIdOfUploading","covertingCount","showSelectImg"])),watch:{value:function(e){this[e?"show":"hide"]()},convertingCount:function(e){0===e&&this.btnLoading&&this.ok()}},created:function(){this.changeCovertingCount(0),this.setFromUploadAction(),this.initCropperInfo(),this.bindEvent()},mounted:function(){!0===this.defaultshow&&this.show()},methods:s({},g(["__set_state","resetStateAction","setInnerStepAction","setSelectedGroupAction","setSelectedImgsAction","setTotalNumAction","setCurrentPageAction","setCropperInfoAction","setCropImgInfoAction","setCropImgAction","setFromUploadAction","updateGroups","changeCovertingCount","formatData","selectImg","selectGroup","getImagesByBegin","createGroup","pageChange","getContentImg","addImgs","removeImgs","changeViewToSelectedImg","changeViewToAllImg","setTotalNumById","resetSelectedImgs"]),{bindEvent:function(){var e=this
window.addEventListener("resize",function(){e.timer&&clearTimeout(e.timer),e.timer=setTimeout(function(){!e.fromcontent&&e.calculatePerpage()&&e.refreshData()},250)})},initStateAction:function(){this.__set_state({scene:this.scene,maxSelect:this.maxselect})},calculatePerpage:function(e){var t=!1
this.dialogStyle.height="0px"
var i=this.$refs.dialog,o=i&&i.$refs.main,s=l(o&&o.querySelector(".weui-desktop-dialog"))
if(0===s)return!1
if(!this.oriListHeight){var n=this.$refs.imgPickerWrapper
this.oriListHeight=l(n,!0)}var r=e||window.innerHeight-s+this.oriListHeight,a=Math.floor(r/this.imgItemHeight)
return a=a<2?2:a,r/this.imgItemHeight-a!=0&&(r=this.imgItemHeight*a),this.lastListHeight===r&&!e||(t=!0),this.__set_state({perpage:6*a}),this.lastListHeight=r,this.dialogStyle.height=r+"px",t},show:function(){this.initStateAction(),this.oldCropImgInfo=JSON.parse(JSON.stringify(this.cropImgInfo)),this.oldCropperInfo=JSON.parse(JSON.stringify(this.cropperInfo)),this.oldCropImg=this.cropImg,this.setCropImgAction({url:this.src||""}),this.stepChange(this.step),this.setSelectedGroupAction(this.defaultgroup),this.setCurrentPageAction(1),this.fromcontent||(this.calculatePerpage(),this.refreshData()),this.dialogShow=!0,this.$emit("visible-change",!0)},refreshData:function(){var t=this
this.__set_state({showLoading:!0})
var e=(this.currentPage-1)*this.perpage
this.getImagesByBegin(e).then(function(e){t.formatData(e).then(function(){t.__set_state({showLoading:!1})}).catch(function(){t.__set_state({showLoading:!1})}),t.setTotalNumById(e.page_info.file_group_list.file_group)}).catch(function(){t.__set_state({showLoading:!1})})},hide:function(){this.dialogShow=!1,this.$emit("visible-change",!1),this.resetStateAction()},stepChange:function(e){this.setInnerStepAction(e),this.$emit("step-change",e)},contentImgChange:function(e){this.setSelectedImgsAction(e)},initCropperInfo:function(){var e=this.ratio.length
this.cropInfo.length===e?this.setCropperInfoAction(this.cropInfo):this.setCropperInfoAction(new Array(e))},clickAddGroup:function(){this.__set_state({addGroupPopoverShow:!0})},cancelAddGroup:function(){this.__set_state({addGroupPopoverShow:!1})},groupNameInput:function(e){console.log("groupNameInput",e),this.__set_state({groupName:e})},cropChange:function(e){this.setCropImgInfoAction(e),this.setCropperInfoAction(e.map(function(e){return e.info}))},prevStep:function(){this.stepChange(1),this.setCropImgInfoAction([])},addGroup:function(){var t=this
this.$refs.addGroupForm.validate(function(e){e?t.createGroup():console.log("validate fail")})},close:function(){this.oldCropImgInfo&&this.setCropImgInfoAction(this.oldCropImgInfo),this.oldCropperInfo&&this.setCropperInfoAction(this.oldCropperInfo),this.oldCropImg&&this.setCropImgAction(this.oldCropImg),this.oldCropImgInfo=null,this.oldCropperInfo=null,this.oldCropImg=null,this.setCurrentPageAction(1),this.hide(),this.$emit("close")},ok:function(){var t=this
if("cdn"===this.scene&&0<this.covertingCount)this.__set_state({btnLoading:!0})
else if(this.__set_state({btnLoading:!1}),this.resetSelectedImgs(),this.crop)if(1===this.innerStep)"gif"===this.selectedImgs[0].format?this.$tipsErr("封面图不支持GIF，请更换"):(this.stepChange(2),this.setCropperInfoAction([]),this.setCropImgAction(this.selectedImgs[0]))
else{this.stepChange(1)
var e=s({},this.cropImg);-1!==this.fromUpload.indexOf(e.fileId+"")?e.source="upload":e.source="lib",this.$emit("select",{img:e,info:this.cropImgInfo}),this.hide()}else this.$emit("select",this.selectedImgs.map(function(e){return-1!==t.fromUpload.indexOf(e.fileId+"")?e.source="upload":e.source="lib",e})),this.hide()},uploadSelect:function(){3===this.uploadscene&&((new Image).src="/mp/jsmonitor?idkey=69271_34_1"),this.__set_state({groupIdOfUploading:this.selectedGroup?this.selectedGroup:this.uploadgroup}),this.uploadSuccessNum=0},uploadError:function(e,t){this.$tipsErr(t||"上传失败")},uploadProgress:function(t,e){console.log("percentage",e)
var i=!1
this.imgs.forEach(function(e){return e.id!==t.id||(t=e,!(i=!0))}),t.progress=100*e,t.cdn_url="",i||this.addImgs({item:t,selected:!0})},removeImgItem:function(e,t){this.removeImgs(t)},uploadComplete:function(e,t){0===Number(t.base_resp.ret)?(3===this.uploadscene&&((new Image).src="/mp/jsmonitor?idkey=69271_35_1"),this.$tipsSuc("上传成功"),this.setFromUploadAction(t.content),this.uploadSuccessNum++):3===this.uploadscene&&((new Image).src="/mp/jsmonitor?idkey=69271_36_1")},uploadAllComplete:function(t){var i=this
if(!((t=this.uploadSuccessNum)<=0)){var o=void 0
if(this.groups.forEach(function(e,t){e.id===i.groupIdOfUploading&&(o=t)}),0<=o){var e=s({},this.groups[o])
e.count+=t,this.updateGroups({idx:o,item:e})}this.groupIdOfUploading===(this.selectedGroup?this.selectedGroup:this.uploadgroup)&&(this.__set_state({showLoading:!0}),this.getImagesByBegin(0).then(function(e){i.formatData(e).then(function(){i.__set_state({showLoading:!1})
for(var e=t-1;0<=e;e--)i.selectedImgs.length<i.maxSelect&&i.selectImg({i:e,currentImg:i.imgs[e],forceSelect:!0});[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t]
return i}return Array.from(e)}(i.imgs)).forEach(function(e,t){c(i.selectedImgs,e)&&i.selectImg({i:t,currentImg:e,forceSelect:!0})})}).catch(function(){i.__set_state({showLoading:!1})})}).catch(function(){i.__set_state({showLoading:!1})}))}}}),filters:{getSelectedImgLength:function(e){return e.filter(function(e){return e.selected}).length}}})})
define("pages/modules/upload/item.js",["pages/modules/upload/item.tpl.js"],function(e,t,i){"use strict"
var p=e("pages/modules/upload/item.tpl.js")
Vue.component("mp-upload-item",{name:"mp-upload-item",template:p,props:{file:{type:Object,default:function(){return{}}}},methods:{preview:function(){this.$emit("preview",this.file)},remove:function(){this.$emit("remove",this.file)}}})})
define("pages/modules/upload/item.tpl.js",[],function(e,i,s){return'<li class="weui-desktop-upload__file weui-desktop-upload__file_image-holder">  <div class="weui-desktop-image-holder__wrp">    <template v-if="file.loading">            <span class="weui-desktop-upload__file__progress__wrp">        <em class="weui-desktop-upload__file__progress" :style="{ width: file.progress + \'%\' }">{{ file.progress }}%</em>      </span>    </template>    <template v-else>            <i class="weui-desktop-upload__file__msg" v-if="file.msg" v-html="file.msg"></i>            <i class="weui-desktop-image-holder__preview" v-else style="background-image: url(\'http://dayu.oa.com/avatars/zhikaimai/profile.jpg\');" @click="preview"></i>            <span class="weui-desktop-image-holder__mask">        <a v-if="!$slots.mask" href="javascript:;" @click="remove(file.id)">删除</a>        <slot name="mask"></slot>      </span>    </template>  </div>    <div class="weui-desktop-upload__file__title" v-if="file.name">{{file.name}}</div></li>'})
define("pages/modules/media_dialog/image_dialog/image_dialog.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.weui-desktop-upload_global-media {  position: relative;  display: inline-block;  text-align: left;}.weui-desktop-upload_global-media .weui-desktop-upload__tips {  display: inline-block;  vertical-align: middle;  margin-right: 5px;  padding-bottom: 0;}.weui-desktop-upload_global-media .weui-desktop-upload__files {  position: absolute;  right: 0;  z-index: 1;  background-color: #FFFFFF;  padding: 5px 10px;  border: 1px solid #E4E8EB;  white-space: nowrap;  margin-top: -1px;}.weui-desktop-upload_global-media .weui-desktop-upload__file__info__area {  margin: 0;}.weui-desktop-dialog_img-picker {  -webkit-user-select: none;      -ms-user-select: none;          user-select: none;}.weui-desktop-dialog_img-picker .weui-desktop-media-tips {  position: absolute;  top: 50%;  left: 50%;  margin-top: -20px;  margin-left: -20px;  height: auto;}.weui-desktop-dialog_img-picker .weui-desktop-dialog {  width: 980px;}.weui-desktop-dialog_img-picker .weui-desktop-dialog__ft {  position: relative;}.weui-desktop-dialog_img-picker .weui-desktop-step__panel {  height: auto;  overflow-y: visible;}.weui-desktop-dialog_img-picker .weui-desktop-media-global-bar {  padding-top: 0;  padding-bottom: 0;  border-bottom: 0;}.weui-desktop-dialog_img-picker .weui-desktop-upload__tips {  margin-right: 8px;  margin-bottom: 0;}.weui-desktop-dialog_img-picker .weui-desktop-upload__file.weui-desktop-upload__file_image-holder {  width: 110px;}.weui-desktop-dialog_img-picker .weui-desktop-upload__file.weui-desktop-upload__file_image-holder .weui-desktop-upload__file__title {  margin-top: 8px;  text-align: center;  line-height: 20px;}.weui-desktop-dialog_img-picker .weui-desktop-upload__file .weui-desktop-image-holder__wrp {  border-width: 2px;  border-radius: 2px;  box-sizing: border-box;  height: 110px;}.weui-desktop-dialog_img-picker-with-crop .weui-desktop-dialog__hd {  padding-top: 24px;  line-height: 1.6;}.weui-desktop-dialog_img-picker-with-crop .weui-desktop-dialog__close-btn {  top: 27px;  margin-top: 0;}.weui-desktop-dialog_img-picker-with-crop .page_msg {  margin: 120px;}.weui-desktop-dialog_img-picker-with-crop .weui-desktop-img-picker__list__area {  margin-top: 20px;}.weui-desktop-img-picker {  display: -ms-flexbox;  display: flex;}.weui-desktop-img-picker > .weui-desktop-grid__item:first-child {  width: 190px;  margin-right: -1px;}.weui-desktop-img-picker > .weui-desktop-grid__item:last-child {  -ms-flex: 1;      flex: 1;}.weui-desktop-img-category {  border-right: 1px solid #E4E8EB;  display: -ms-flexbox;  display: flex;  -ms-flex-direction: column;      flex-direction: column;}.weui-desktop-img-category .weui-desktop-menu {  height: 400px;  overflow-y: auto;  -ms-flex-positive: 1;      flex-grow: 1;}.weui-desktop-img-category .weui-desktop-menu__item > .weui-desktop-menu__link:before {  display: none;}.weui-desktop-img-category .weui-desktop-menu__item .weui-desktop-menu__link_current {  border-left-color: transparent;  background-color: rgba(0, 0, 0, 0.03);}.weui-desktop-img-category .weui-desktop-menu__link {  padding-left: 28px;  line-height: 40px;}.weui-desktop-img-category .weui-desktop-popover__wrp {  display: inline-block;  vertical-align: top;}.weui-desktop-img-category .weui-desktop-popover__wrp .weui-desktop-popover {  padding-top: 0;  margin-left: 0;}.weui-desktop-img-category__title {  color: #353535;  width: auto;  overflow: hidden;  text-overflow: ellipsis;  white-space: nowrap;  word-wrap: normal;  max-width: 8em;  font-weight: 400;}.weui-desktop-img-category__size {  color: #9A9A9A;  font-style: normal;}.weui-desktop-img-category__add {  display: block;  line-height: 40px;  padding-left: 32px;}.weui-desktop-img-picker__list__area {  border-left: 1px solid #E4E8EB;}.weui-desktop-img-picker__list__wrp {  position: relative;  margin-top: 30px;  overflow: auto;}.weui-desktop-img-picker__list__wrp + .weui-desktop-pagination {  padding: 10px 20px 20px;}.weui-desktop-img-picker__list {  margin: 0 auto;  width: 725px;  overflow: auto;}.weui-desktop-img-picker__item {  cursor: pointer;  position: relative;  float: left;  width: 110px;  margin: 0 13px 20px 0;}.weui-desktop-img-picker__item:hover .weui-desktop-img-picker__img-thumb {  box-shadow: 0 0 0 2px #8CD68C inset;}.weui-desktop-img-picker__item:nth-child(6n) {  margin-right: 0;}.weui-desktop-img-picker__item.selected .weui-desktop-img-picker__img-thumb {  box-shadow: 0 0 0 2px #07C160 inset;}.weui-desktop-img-picker__item.selected .weui-desktop-img-picker__img-thumb::before {  content: '';  position: absolute;  top: 0;  right: 0;  bottom: 0;  left: 0;  background-color: #07C160;  opacity: 0.1;}.weui-desktop-img-picker__item.disabled {  opacity: .5;}.weui-desktop-img-picker__item.disabled .weui-desktop-img-picker__img-thumb {  border-color: transparent;}.weui-desktop-img-picker__item.disabled .image_dialog__checkbox {  display: none;}.weui-desktop-img-picker__img-thumb {  position: relative;  display: block;  width: 110px;  height: 110px;  -webkit-background-size: contain;  background-size: contain;  background-position: 50% 50%;  background-repeat: no-repeat;  box-sizing: border-box;  border-radius: 2px;  overflow: hidden;}.weui-desktop-img-picker__img-title {  margin-top: 8px;  display: block;  width: auto;  overflow: hidden;  text-overflow: ellipsis;  white-space: nowrap;  word-wrap: normal;  font-weight: 400;  line-height: 20px;  text-align: center;}.weui-desktop-img-picker__counter {  position: absolute;  top: 24px;  left: 32px;  line-height: 2.42857143;}.weui-desktop-img-picker__counter span {  display: inline-block;  margin-right: .5em;}.weui-desktop-img-picker__counter strong {  font-weight: normal;  color: #576B95;}.image_dialog__checkbox,.image_dialog__radio {  position: absolute;  top: 5px;  left: 5px;  width: 20px;  height: 20px;  border: 1px solid #fff;  border-radius: 1px;  background-color: rgba(0, 0, 0, 0.2);}.image_dialog__checkbox.selected,.image_dialog__radio.selected {  background-color: #07C160;}.image_dialog__checkbox.selected::before,.image_dialog__radio.selected::before {  content: '';  position: absolute;  top: 5px;  left: 4px;  width: 11px;  height: 6px;  border-left: 1px solid #fff;  border-bottom: 1px solid #fff;  -ms-transform: rotate(-45deg);      transform: rotate(-45deg);}.image_dialog__radio {  border-radius: 50%;}";});define("pages/modules/media_dialog/image_dialog/image_crop.js",["3rd/jquery/jquery.2.1.4.js","pages/modules/crop/jquery.Jcrop.js","pages/modules/media_dialog/image_dialog/image_crop.css.js","pages/modules/media_dialog/image_dialog/image_crop.tpl.js"],function(i,t,r){"use strict"
i("3rd/jquery/jquery.2.1.4.js"),i("pages/modules/crop/jquery.Jcrop.js"),i("pages/modules/media_dialog/image_dialog/image_crop.css.js")
var e=i("pages/modules/media_dialog/image_dialog/image_crop.tpl.js")
Vue.component("mp-image-crop",{template:e,props:{src:{type:String,default:""},ratio:{type:Array,default:function(){return[{title:"图文封面",ratio:1}]}},cropInfo:{type:Array,default:function(){return[]}},shouldHideRatioTabs:{type:Boolean,default:!1}},data:function(){return{imgReady:!1,ratioIdx:0,ratioList:[]}},watch:{cropInfo:function(i){var t=this.ratio.length
i.length===t?this.cropperInfo=i:this.cropperInfo=new Array(t)}},filters:{ratioText:function(i){return i===16/9?"16:9":i===4/3?"4:3":i===5/4?"5:4":(i*=100).toFixed(0)/100+":1"}},created:function(){var i=this.ratio.length
this.cropperBoundx=new Array(i),this.cropperBoundy=new Array(i),this.imgCropper=new Array(i),this.cropInfo.length===i?this.cropperInfo=this.cropInfo:this.cropperInfo=new Array(i)
for(var t=0;t<this.ratio.length;++t)if(this.ratioList.push(this.ratio[t]),this.ratio[t].children&&this.ratio[t].children.length){for(var r=this.ratio[t].ratio,e=0;e<this.ratio[t].children.length;++e){var o=this.ratio[t].children[e]
o.isChildRatio=!0,o.ratio===r?(this.ratio[t].title+="、"+o.title,this.ratio[t].desc+="；"+o.desc,this.ratio[t].children.splice(e,1),--e):this.ratioList.push(o)}if(this.ratio[t].children.length<3)throw new Error("ratio children length is less than 3")}},methods:{imgLoad:function(i){var t=this.ratio.length
if(i===t-1){this.imgReady=!0
var r=window.$(this.$refs.img[0])
this.width=r.width(),this.height=r.height()
for(var e=0;e<t;e++)this.initImageCropper(e)}},switchIdx:function(i){this.ratioIdx=i,this.initImageCropper(i)},initImageCropper:function(d){var p=this,c=new Image
c.onload=function(){this.onerror=null,this.onload=null,c=null
var i=p.imgCropper[d]
i&&"function"==typeof i.destroy&&(i.destroy(),i=null)
var t=void 0,r=void 0,e=void 0,o=void 0
if(p.cropperInfo[d]){var h=p.cropperInfo[d]
t=h.x,r=h.y,e=h.x2,o=h.y2}else{p.emitChange()
var a=p.width/p.ratio[d].ratio,n=void 0
n=a>p.height?(a=p.height,p.height*p.ratio[d].ratio):p.width,t=(p.width-n)/2,r=(p.height-a)/2,e=p.width-t,o=p.height-r}var s=window.$(p.$refs.img[d])
s.width(),s.Jcrop({onChange:function(i){if(p.updatePreview(i,d),p.ratio[d].children)for(var t=0;t<p.ratio[d].children.length;++t){var r={},e=p.ratio[d].children[t].ratio;(1<e||e<1)&&p.ratio[d].ratio>=e||1===e&&1<p.ratio[d].ratio?(r.h=i.h,r.w=i.h*e,r.x=(i.w-r.w)/2+i.x,r.y=i.y):(r.w=i.w,r.h=i.w/e,r.x=i.x,r.y=(i.h-r.h)/2+i.y),r.x2=r.x+r.w,r.y2=r.y+r.h,p.updatePreview(r,d+t+1)}},onSelect:function(i){p.updatePreview(i,d)},setSelect:[t,r,e,o],createHandles:["nw","ne","se","sw"],aspectRatio:p.ratio[d].ratio,boxWidth:p.width,boxHeight:p.height,allowSelect:!1,shade:!0,bgOpacity:.5,bgColor:"black"},function(){var i=this.getBounds()
p.cropperBoundx[d]=i[0],p.cropperBoundy[d]=i[1]
var t=(p.imgCropper[d]=this).tellSelect(),r=window.$(p.$refs.preview[d]),e=r.width()/t.w,o=r.height()/t.h
window.$(p.$refs.previewImg[d]).css({width:Math.round(e*p.cropperBoundx[d])+"px",height:Math.round(o*p.cropperBoundy[d])+"px",marginLeft:"-"+Math.round(e*t.x)+"px",marginTop:"-"+Math.round(o*t.y)+"px"}),s.parent().find(".jcrop-handle",this.ui.selection).css({width:"7px",height:"7px"})})},c.onerror=function(){p.$tipsErr("图片上传失败"),this.onerror=null,this.onload=null,c=null},c.src=this.src},updatePreview:function(i,t){if(!(0<window.parseInt(i.w)))throw new Error("图片宽度为0"+i)
this.cropperInfo[t]=i
var r=window.$(this.$refs.preview[t]),e=r.width()/i.w,o=r.height()/i.h
window.$(this.$refs.previewImg[t]).css({width:this.cropperBoundx[t]?Math.round(e*this.cropperBoundx[t])+"px":Math.round(e*this.width)+"px",height:this.cropperBoundy[t]?Math.round(o*this.cropperBoundy[t])+"px":Math.round(o*this.height)+"px",marginLeft:"-"+Math.round(e*i.x)+"px",marginTop:"-"+Math.round(o*i.y)+"px"}),this.emitChange()},emitChange:function(){var h=this
this.$emit("change",this.cropperInfo.map(function(i){if(i){var t=i.x/h.width,r=i.y/h.height,e=i.x2/h.width,o=i.y2/h.height
return{x1:t<0?0:t,y1:r<0?0:r,x2:1<e?1:e,y2:1<o?1:o,info:i}}}))}}})})
define("pages/modules/media_dialog/image_dialog/image_crop.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.img_crop_panel {  height: 365px;  overflow-y: auto;}.img_crop_panel .inner_container_box {  border-width: 0;}.img_crop_area {  padding: 15px 25px 0;}.img_crop_area:after {  content: \"\\200B\";  display: block;  height: 0;  clear: both;}.img_crop_area .jcrop-holder {  display: inline-block;  vertical-align: middle;}.img_crop_area .img_crop_origin_area {  float: left;}.img_crop_wrp {  border: 1px solid #E4E8EB;  background-color: #f4f5f9;  display: inline-block;  vertical-align: top;  width: 245px;  height: 245px;  text-align: center;  font-size: 0;}.img_crop_wrp:after {  content: \" \";  display: inline-block;  vertical-align: middle;  width: 0;  height: 100%;  overflow: hidden;}.img_crop_wrp .img_crop_origin {  max-width: 100%;  max-height: 100%;  vertical-align: middle;}.img_crop_wrp .img_crop_img_hidden {  position: absolute;  left: -1000px;}.img_crop_wrp .img_crop_img {  max-width: 245px;  max-height: 226px;}.img_crop_hd {  padding-bottom: 10px;}.img_crop_ft {  padding-top: 20px;  text-align: left;  padding-left: 15px;}.img_crop_ft .weui-desktop-button-group {  margin-top: 10px;}.img_crop_ft .weui-desktop-btn {  position: relative;  background: none;  line-height: 28px;  border-color: #E4E8EB;  border-right: none;  border-left: none;  color: #9A9A9A;}.img_crop_ft .weui-desktop-btn:hover {  cursor: pointer;}.img_crop_ft .weui-desktop-btn:before {  position: absolute;  top: 50%;  margin-top: -7px;  right: 0;  content: ' ';  display: block;  width: 0;  height: 14px;  border-left: 1px solid #E4E8EB;}.img_crop_ft .weui-desktop-btn:first-child {  border-left: 1px solid #E4E8EB;}.img_crop_ft .weui-desktop-btn:last-child {  border-right: 1px solid #E4E8EB;}.img_crop_ft .weui-desktop-btn:last-child:before {  display: none;}.img_crop_ft .weui-desktop-btn.weui-desktop-btn_current {  color: #07C160;}.img_crop_title {  font-weight: 400;  text-align: left;  padding-left: 20px;}.img_crop_preview_area {  float: none;  display: table-cell;  vertical-align: top;  width: auto;  border-left: 1px solid #E7E7EB;  height: 342px;}.img_crop_preview_area:after {  content: \" . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . \";  display: block;  clear: both;  height: 0;  line-height: 0;  visibility: hidden;}.img_crop_edit_area {  float: left;  margin-right: 10px;  width: 280px;  text-align: center;}.img_crop_edit_area .img_crop_wrp {  height: 226px;}.img_crop_preview_item {  margin-bottom: 20px;  padding-left: 20px;}.img_crop_preview_item:after {  content: \"\\200B\";  display: block;  height: 0;  clear: both;}.img_crop_preview_item:hover {  background-color: #F6F8F9;  cursor: pointer;}.img_crop_preview_item.current {  position: relative;}.img_crop_preview_item.current:before {  content: ' ';  display: block;  width: 4px;  height: 100%;  background-color: #07C160;  position: absolute;  top: 0;  left: -1px;}.img_crop_preview_item:last-child {  margin-bottom: 11px;}.img_crop_preview_hd {  float: left;  margin-right: 14px;  background-color: #F6F8F9;  overflow: hidden;}.img_crop_preview_hd img {  width: 100%;}.img_crop_preview_bd {  overflow: auto;}.img_crop_preview_title {  font-weight: 400;}.img_crop_preview_desc {  color: #9A9A9A;}";});define("pages/modules/media_dialog/image_dialog/image_crop.tpl.js",[],function(i,e,s){return'<div class="img_crop_area">    <div class="img_crop_edit_area">    <div class="img_crop_hd">      <h4 class="img_crop_title">剪裁封面</h4>    </div>    <div class="img_crop_wrp" style="background-color:white;">      <i v-if="src && !imgReady" class="weui-desktop-loading"></i>      <template v-if="src">        <span v-for="(item, idx) in ratio" :class="{\'img_crop_img_hidden\': ratioIdx !== idx}">          <img class="img_crop_img" v-show="imgReady" :src="src" @load="imgLoad(idx)" ref="img">        </span>      </template>    </div>    <div class="img_crop_ft">      <p v-if="ratio[ratioIdx] ? ratio[ratioIdx].cropDescription : false" class="img_crop_preview_desc">                {{ ratio[ratioIdx].cropDescription }}      </p>      <div class="weui-desktop-button-group" v-if="!shouldHideRatioTabs">        <button v-for="(item, idx) in ratio" @click="switchIdx(idx)" class="weui-desktop-btn weui-desktop-btn_default" :class="{\'weui-desktop-btn_current\': ratioIdx === idx}">{{ item.ratio | ratioText }}</button>      </div>    </div>  </div>    <div class="img_crop_preview_area">    <div class="img_crop_hd">      <h4 class="img_crop_title">预览封面</h4>    </div>    <ul class="img_crop_preview_list">            <li v-for="(item, idx) in ratioList" :data-ratio="item.ratio" @click="!item.isChildRatio ? switchIdx(idx) : null" class="img_crop_preview_item">        <span style="width: 130px" :style="{\'height\': \'calc(130px / \' + item.ratio + \')\'}" class="img_crop_preview_hd" ref="preview">          <img v-show="imgReady" style="width: 130px" :src="src" ref="previewImg">        </span>        <div class="img_crop_preview_bd">          <strong class="img_crop_preview_title">            {{ item.title }}（{{ item.ratio | ratioText }}）          </strong>          <p v-if="item.desc" class="img_crop_preview_desc">            {{ item.desc }}          </p>        </div>      </li>    </ul>  </div></div>'})
define("pages/modules/media_dialog/image_dialog/image_content.js",["3rd/jquery/jquery.2.1.4.js","pages/modules/media_dialog/image_dialog/image_crop.css.js","pages/modules/media_dialog/image_dialog/image_content.tpl.js"],function(e,t,i){"use strict"
var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]
for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e}
function r(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t]
return i}return Array.from(e)}e("3rd/jquery/jquery.2.1.4.js"),e("pages/modules/media_dialog/image_dialog/image_crop.css.js")
var s=e("pages/modules/media_dialog/image_dialog/image_content.tpl.js")
Vue.component("mp-image-content",{template:s,props:{imgUrls:{type:Array,default:function(){return[]}},maxselect:{type:Number,default:1},selectedImgs:{type:Array,default:function(){return[]}}},data:function(){return{noImgShow:!0,imgInfo:[]}},created:function(){},mounted:function(){this.getContentImg(this.imgUrls)},methods:{getContentImg:function(e){var i=this
e.forEach(function(t){var e=new window.Image
e.onload=function(){this.onload=null
var e=200<=this.width&&200<=this.height
i.imgInfo.push({isRemote:t.isRemote,uid:t.uid,url:t.url,show:e,selected:!1,format:i.getFormat(t.url)}),e&&(i.noImgShow=!e)},e.src=t.url})},selectImg:function(i){var e=n({},this.imgInfo[i]),t=[]
if(e.selected){this.imgInfo[i].selected=!1
var s=function(e,t){for(var i=0,s=e.length;i<s;i++)if(e[i].url===t)return i
return-1}(this.selectedImgs,this.imgInfo[i].url)
t=[].concat(r(this.selectedImgs)),0<=s&&t.splice(s,1),this.$emit("select-change",t)}else 1===this.maxselect?(this.imgInfo=this.imgInfo.map(function(e,t){return e.selected=t===i,e}),e.selected=!0,t.push(e),this.$emit("select-change",t)):this.selectedImgs.length<this.maxselect&&(this.imgInfo[i].selected=!0,t=[].concat(r(this.selectedImgs),[this.imgInfo[i]]),this.$emit("select-change",t))},getFormat:function(e){return e.substring(e.search("wx_fmt=")).split("=")[1]}}})})
